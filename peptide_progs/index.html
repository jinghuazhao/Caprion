<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Peptide analysis - Caprion</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/Bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/HTML.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/Java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/JavaScript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/Perl.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/Python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/R.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
<div class="container">
<a class="navbar-brand" href="..">Caprion</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href=".."></a>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pilot studies <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../pilot/autoencoder/">Autoencoder</a>
</li>
<li>
<a class="dropdown-item" href="../pilot/gwas2/">gwas2</a>
</li>
<li>
<a class="dropdown-item" href="../pilot/">Pilot studies</a>
</li>
</ul>
</li>
<li class="dropdown active">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Analysis <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../progs/">Protein analysis</a>
</li>
<li>
<a class="dropdown-item active" href="./">Peptide analysis</a>
</li>
<li>
<a class="dropdown-item" href="../misc/">Miscellaneous analysis</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Additional information <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="https://jinghuazhao.github.io/pQTLdata/reference/caprion.html">Caprion panel</a>
</li>
<li>
<a class="dropdown-item" href="../Notes/">Notes</a>
</li>
</ul>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" data-target="#mkdocs_search_modal" data-toggle="modal" href="#">
<i class="fa fa-search"></i> Search
                            </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../progs/" rel="prev">
<i class="fa fa-arrow-left"></i> Previous
                                </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../misc/" rel="next">
                                    Next <i class="fa fa-arrow-right"></i>
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://github.com/jinghuazhao/Caprion"><i class="fa fa-github"></i> GitHub</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
<li class="nav-item" data-level="1"><a class="nav-link" href="#peptide-analysis">Peptide analysis</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="2"><a class="nav-link" href="#csd3-directory">CSD3 directory</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#scripts-and-results">Scripts and results</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#glossary">Glossary</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#references">References</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<h1 id="peptide-analysis">Peptide analysis</h1>
<h2 id="csd3-directory">CSD3 directory</h2>
<p><strong>/rds/project/jmmh2/rds-jmmh2-projects/Caprion_proteomics/analysis/</strong></p>
<h2 id="scripts-and-results">Scripts and results</h2>
<p>The project directory above contains scripts at <strong>peptide_progs/</strong> and results results at <strong>peptide/</strong>, respectively.</p>
<p>These are also a set of scripts called from <code>bash</code> which invokes SLURM jobs.</p>
<table>
<thead>
<tr>
<th>Script name</th>
<th>Description</th>
<th>Protein-specific error/output</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Association analysis</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1_pgwas.sh</td>
<td>Association analysis</td>
<td>{protein}.e / {protein}.o</td>
</tr>
<tr>
<td>2_meta_analysis.sh</td>
<td>Meta-analysis</td>
<td>{protein}-METAL_{SLURM_job_id}_{phenotype_number}.e / {protein}-METAL_{SLURM_job_id}_{phenotype_number}.o</td>
</tr>
<tr>
<td><strong>Signal identification</strong> (see <strong>{protein}/sentinels/slurm</strong>)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>setup.sh</td>
<td>Environmental variables</td>
<td></td>
</tr>
<tr>
<td>3.1_extract.sh</td>
<td>Signal extraction</td>
<td>_step1_{SLURM_job_id}_{phenotype_number}.e / _step1_{SLURM_job_id}_{phenotype_number}.o</td>
</tr>
<tr>
<td>3.2_collect.sh</td>
<td>Signal collection/classification</td>
<td>_step2_{protein}.e / _step2_{protein}.o</td>
</tr>
<tr>
<td>3.3_plot.sh</td>
<td>Forest, Q-Q, Manhattan, LocusZoom, mean-by-genotype/dosage plots</td>
<td>_step3_{SLURM_job_id}_{phenotype_number}.e / _step3_{SLURM_job_id}_{phenotype_number}.o</td>
</tr>
<tr>
<td>utils.sh</td>
<td>Various utitlties</td>
<td></td>
</tr>
</tbody>
</table>
<div style="text-align: center;">
<div class="mermaid">graph TD;
    1_pgwas.sh
    2_meta_analysis.sh
    1_pgwas.sh --&gt; 2_meta_analysis.sh --&gt; setup.sh
    setup.sh --&gt; 3.1_extract.sh
    setup.sh --&gt; 3.2_collect.sh
    setup.sh --&gt; 3.3_plot.sh

    subgraph Group1[ ]
        direction LR
        3.1_extract.sh --&gt; 3.2_collect.sh --&gt; 3.3_plot.sh
    end

    utils.sh
</div>
</div>
<p>Specfic prerequistes for a Manhattan/peptide association plot are</p>
<ul>
<li>a call to vep_annotate functino in <code>3.2_collect.sh</code> for proteins.</li>
<li>a call to <code>bgz()</code> (in <code>utils.sh</code> for protein) for a indexed and compressed DR-filtered data.</li>
<li>for step 3.2, <code>ceuadmin/ensembl-vep/111-icelake</code> now is the default since partition <code>icelake-himem</code> is used instead of <code>cclake</code> (CentOS 7) which has <code>ceuadmin/ensembl-vep/104</code>.</li>
<li>module <code>ceuadmin/R/4.4.1-icelake</code> now works as smoothly as the old <code>ceuadmin/R</code> at <code>cclake</code></li>
</ul>
<table>
<thead>
<tr>
<th>Script name</th>
<th>Description</th>
<th>Protein-specific error/output</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Experimental codes</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>mz.*</td>
<td>file handling &amp; MetaMorpheus, MSAmanda.</td>
<td>mzML and results in */metamorpheus, msamonda</td>
</tr>
<tr>
<td>crux.*</td>
<td>search, R/multicomp+crux benchmark</td>
<td>crux/</td>
</tr>
<tr>
<td>BoxCar.py/pyteomics.py</td>
<td>BoxCar algorighm and its use</td>
<td></td>
</tr>
</tbody>
</table>
<div class="mermaid">graph TD;
mz.*
crux.*
BoxCar.py/pyteomics.py
</div>
<p>The module <code>mono-5.10.0.78-gcc-5.4.0-c6cq4hh</code> is required for <code>rawrr</code>, to <code>${HOME}/.cache/R/rawrr/rawrrassembly</code> (4/8/2024).</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>eula.txt</td>
<td>163</td>
</tr>
<tr>
<td>rawrr.exe</td>
<td>28672</td>
</tr>
<tr>
<td>ThermoFisher.CommonCore.BackgroundSubtraction.dll</td>
<td>44544</td>
</tr>
<tr>
<td>ThermoFisher.CommonCore.Data.dll</td>
<td>406016</td>
</tr>
<tr>
<td>ThermoFisher.CommonCore.MassPrecisionEstimator.dll</td>
<td>11264</td>
</tr>
<tr>
<td>ThermoFisher.CommonCore.RawFileReader.dll</td>
<td>654336</td>
</tr>
</tbody>
</table>
<p>Finally, <code>ceumadin/FragPipe/22.0</code> is available as a GUI for experiments on various worflows.</p>
<h2 id="glossary">Glossary</h2>
<p>The atomic mass unit (dalton) is equal to the mass of one-twelvth of the mass of a <span class="arithmatex">\(^{12}C\)</span> atom (<span class="arithmatex">\(1.660 540 2 \times 10^{-27}\)</span>g).</p>
<h2 id="references">References</h2>
<p>Bittremieux W, Levitsky L, Pilz M, Sachsenberg T, Huber F, Wang M, Dorrestein PC. Unified and standardized mass spectrometry data processing in Python using spectrum_utils. <em>J Proteome Res</em> 22:625–631 (2023), <a href="https://doi.org/10.1021/acs.jproteome.2c00632">https://doi.org/10.1021/acs.jproteome.2c00632</a>, <a href="https://spectrum-utils.readthedocs.io/en/latest/">https://spectrum-utils.readthedocs.io/en/latest/</a>.</p>
<p>Eidhammer I, Flikka K, Martens L, Mikalsen S-O. Computational Methods for Mass Spectrometry Proteomics. Wiley, 2007. ISBN: 978-0-470-51297-5</p>
<details>

1. Peptides are the short stretches of amino acids that are obtained after the proteolytic cleavage of proteins. Peptides are usually around 10–15 amino acids long, and a single protein yields approximately 35 peptides on average.

2. The mass (m) of a molecule or atom is expressed in unified atomic mass units (u).

3. Isotopes are (chemical) elements that have the same atomic number (and therefore similar chemical properties), but different molecular mass (slightly different physical properties).

4. Monoisotopic mass is the exact mass of an ion or molecule calculated using the mass of the most abundant isotope of each element.

5. A posttranslational modification (PTM) can be defined as any alteration to the chemical structure of the protein effected by the cellular machinery after the formation of the protein.

6. The raw data spectrum contains signals from the peptides, as well as signals derived from different forms of noise.

</details>
<p>fragpipe.nesvilab.org, <a href="https://fragpipe.nesvilab.org/">https://fragpipe.nesvilab.org/</a></p>
<p>Hasam S, Emery K, Noble WS, Keich U. A Pipeline for Peptide Detection Using Multiple Decoys. <em>Methods Mol Biol</em> 2023;2426:25-34, <a href="https://link.springer.com/protocol/10.1007/978-1-0716-1967-4_2">doi: 10.1007/978-1-0716-1967-4_2</a>.</p>
<details>

The most common method of peptide and protein False Discovery Rate (FDR) calculation is by adding protein sequences that are not expected to be present in the sample. These are also called decoy protein sequences. This can be done by generating reverse sequences of the target protein entries and appending these protein entries to the protein database. Some search algoritmms use premade target-decoy protein sequences while others can generate a target-decoy protein sequence database from a target protein sequence database before using them for peptide spectral matching.

</details>
<p>Kertesz-Farkas A, Nii Adoquaye Acquaye FL, Bhimani K, Eng JK, Fondrie WE, Grant C, Hoopmann MR, Lin A, Lu YY, Moritz RL, MacCoss MJ, Noble WS. The Crux Toolkit for Analysis of Bottom-Up Tandem Mass Spectrometry Proteomics Data. <em>J Proteome Res</em> 2023;22(2):561-569, <a href="https://doi.org/10.1021/acs.jproteome.2c00615">https://doi.org/10.1021/acs.jproteome.2c00615</a>, <a href="https://crux.ms">https://crux.ms</a>.</p>
<p>Lazear MR. Sage: An Open-Source Tool for Fast Proteomics Searching and Quantification at Scale. <em>J Proteome Res</em> 2023 22 (11), 3652-3659, <a href="https://pubs.acs.org/doi/10.1021/acs.jproteome.3c00486">DOI: 10.1021/acs.jproteome.3c00486</a>.</p>
<p>Levitsky LI, Klein JA, Ivanov MV, Gorshkov MV. Pyteomics 4.0: Five Years of Development of a Python Proteomics Framework. <em>J Proteome Res.</em> 2019;18(2):709-714. <a href="https://pubs.acs.org/doi/10.1021/acs.jproteome.8b00717">doi: 10.1021/acs.jproteome.8b00717</a>, <a href="https://github.com/levitsky/pyteomics">https://github.com/levitsky/pyteomics</a>.</p>
<p>ms-utils.org, <a href="https://ms-utils.org/">https://ms-utils.org/</a>.</p>
<p>Rehfeldt TG, Gabriels R, Bouwmeester R, Gessulat S, Neely BA, Palmblad M, Perez-Riverol Y, Schmidt T, Vizcaíno JA, Deutsch EW. ProteomicsML: An Online Platform for Community-Curated Data sets and Tutorials for Machine Learning in Proteomics. <em>J Proteome Res</em>, 2023;22(2):632-636, <a href="https://doi.org/10.1021/acs.jproteome.2c00629">https://doi.org/10.1021/acs.jproteome.2c00629</a>, <a href="https://proteomicsml.org/">https://proteomicsml.org/</a>.</p>
<p>Sturm M, Bertsch A, Gröpl C, Hildebrandt A, Hussong R, Lange E, Pfeifer N, Schulz-Trieglaff O, Zerck A, Reinert K, Kohlbacher O. OpenMS - an open-source software framework for mass spectrometry. <em>BMC Bioinformatics</em>. 2008;9:163. <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-163">doi: 10.1186/1471-2105-9-163</a>.</p></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script src="../js/jquery-3.6.0.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script src="../js/base.js"></script>
<script src="../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../search/main.js"></script>
<div aria-hidden="true" aria-labelledby="searchModalLabel" class="modal" id="mkdocs_search_modal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="searchModalLabel">Search</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<p>From here you can search these documents. Enter your search terms below.</p>
<form>
<div class="form-group">
<input class="form-control" id="mkdocs-search-query" placeholder="Search..." title="Type search term here" type="search"/>
</div>
</form>
<div data-no-results-text="No results found" id="mkdocs-search-results"></div>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div><div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>
